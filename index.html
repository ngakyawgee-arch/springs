<!DOCTYPE html>
<html lang="my">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>·Äñ·Ä≠·ÄØ·Ä∏·ÄÖ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äê·Ä±·Ä¨·ÄÑ·Ä∫·Äô·ÄÆ·Ä∏·Ä°·Ä≠·Äô·Ä∫ (LFM)</title>

  <meta name="theme-color" content="#c8102e">
  <meta name="description" content="·Äê·Ä±·Ä¨·Ä∫·Äú·Äæ·Äî·Ä∫·Äõ·Ä±·Ä∏ ·Ä°·Äú·Äæ·Ä∞·Äõ·Äæ·ÄÑ·Ä∫·Äô·Äæ·Äê·Ä∫·Äê·Äô·Ä∫·Ä∏ - ·Ä°·Äê·Ä∞·Äê·ÄÄ·ÄΩ ·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äï·ÄΩ·Ä≤·ÄÅ·Ä∂·Äô·Äö·Ä∫ ‚úä">

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <!-- JSConfetti (mini confetti effect) -->
  <script src="https://cdn.jsdelivr.net/npm/js-confetti@latest/dist/js-confetti.browser.js"></script>

  <style>
    :root {
      --red-rev: #c8102e;
      --red-dark: #a00d24;
      --green-hope: #00c853;
      --green-dark: #009624;
      --dark: #0a0a0a;
      --card: #111111;
      --card-hover: #1a1a1a;
      --text: #f0f0f0;
      --muted: #aaaaaa;
    }

    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: 'Noto Sans Myanmar', system-ui, sans-serif;
      background: var(--dark);
      color: var(--text);
      min-height: 100vh;
      padding-bottom: 90px;
    }

    .container { max-width: 640px; margin: 0 auto; padding: 16px; }

    .header {
      text-align: center;
      padding: 24px 0 16px;
      background: linear-gradient(135deg, #1a0000, #000d1a);
      border-radius: 0 0 24px 24px;
      box-shadow: 0 8px 24px rgba(200,16,46,0.2);
    }

    .title {
      font-size: 2.1rem;
      font-weight: 900;
      background: linear-gradient(90deg, var(--red-rev), var(--green-hope));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 8px;
    }

    .subtitle { font-size: 1.05rem; opacity: 0.9; }

    .card {
      background: var(--card);
      border-radius: 16px;
      padding: 20px;
      margin: 16px 0;
      border: 1px solid rgba(200,16,46,0.15);
      transition: all 0.25s ease;
    }

    .card:hover { transform: translateY(-4px); box-shadow: 0 12px 32px rgba(200,16,46,0.18); }

    h3 { 
      color: var(--green-hope); 
      margin-bottom: 16px; 
      font-size: 1.35rem; 
      border-bottom: 2px solid var(--red-rev); 
      padding-bottom: 8px; 
    }

    input, button {
      width: 100%;
      padding: 14px 16px;
      margin: 10px 0;
      border-radius: 12px;
      font-size: 1rem;
      border: none;
      transition: all 0.2s;
    }

    input {
      background: #1e1e1e;
      color: white;
    }

    input:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(200,16,46,0.4);
    }

    .btn {
      font-weight: bold;
      cursor: pointer;
    }

    .btn-primary {
      background: linear-gradient(90deg, var(--red-rev), #e91e63);
      color: white;
    }

    .btn-primary:hover { filter: brightness(1.1); transform: translateY(-2px); }

    .quick-amounts {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin: 12px 0;
    }

    .quick-btn {
      background: #222;
      color: var(--green-hope);
      border: 1px solid var(--green-hope);
      font-weight: bold;
    }

    .quick-btn.active {
      background: var(--green-hope);
      color: black;
    }

    .donation-item {
      background: rgba(200,16,46,0.08);
      border-left: 5px solid var(--red-rev);
      padding: 16px;
      border-radius: 12px;
      margin: 12px 0;
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 0.5s forwards;
    }

    @keyframes fadeInUp {
      to { opacity:1; transform:translateY(0); }
    }

    .total-box {
      text-align: center;
      padding: 32px 16px;
      background: linear-gradient(135deg, rgba(200,16,46,0.15), rgba(0,200,83,0.15));
      border-radius: 20px;
      margin: 20px 0;
    }

    .total-amount {
      font-size: 3.2rem;
      font-weight: 900;
      color: var(--green-hope);
      text-shadow: 0 4px 12px rgba(0,200,83,0.4);
    }

    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0; right: 0;
      background: rgba(17,17,17,0.92);
      backdrop-filter: blur(12px);
      border-top: 1px solid rgba(200,16,46,0.3);
      display: flex;
      padding: 10px 0;
      z-index: 100;
    }

    .nav-btn {
      flex: 1;
      background: none;
      border: none;
      color: var(--muted);
      font-size: 0.8rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      padding: 8px;
    }

    .nav-btn.active, .nav-btn:hover {
      color: var(--green-hope);
    }

    .emoji-lg { font-size: 2.2rem; margin-bottom: 4px; }

    .hide { display: none !important; }
  </style>
</head>
<body>

<div class="container">

  <!-- Header -->
  <div class="header">
    <div class="title">‚úä ·Äñ·Ä≠·ÄØ·Ä∏·ÄÖ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äê·Ä±·Ä¨·ÄÑ·Ä∫ ·Äô·ÄÆ·Ä∏·Ä°·Ä≠·Äô·Ä∫</div>
    <div class="subtitle">·Äê·Ä±·Ä¨·Ä∫·Äú·Äæ·Äî·Ä∫·Äõ·Ä±·Ä∏ ·Ä°·Äú·Äæ·Ä∞·Äõ·Äæ·ÄÑ·Ä∫·Äô·Äæ·Äê·Ä∫·Äê·Äô·Ä∫·Ä∏</div>
  </div>

  <!-- Total -->
  <div class="total-box">
    <div style="font-size:1.1rem; opacity:0.9; margin-bottom:8px;">·ÄÖ·ÄØ·ÄÖ·ÄØ·Äï·Ä±·Ä´·ÄÑ·Ä∫·Ä∏ ·Ä°·Äú·Äæ·Ä∞·ÄÑ·ÄΩ·Ä±</div>
    <div class="total-amount" id="totalAmount">0</div>
    <div style="margin-top:8px; font-size:1.1rem;">·Äò·Äê·Ä∫</div>
  </div>

  <!-- Donation Form -->
  <div class="card">
    <h3>·Ä°·Äú·Äæ·Ä∞ ·Äë·Ää·Ä∑·Ä∫·Äõ·Äî·Ä∫</h3>
    
    <input id="donorName" placeholder="·Ä°·Äô·Ää·Ä∫ / ·Ä°·Äñ·ÄΩ·Ä≤·Ä∑·Ä°·Äô·Ää·Ä∫" autocomplete="off" list="nameSuggestions"/>
    <datalist id="nameSuggestions"></datalist>

    <input id="donationAmount" type="number" placeholder="·ÄÑ·ÄΩ·Ä±·Äï·Äô·Ä¨·Äè (·Äò·Äê·Ä∫)" min="100"/>

    <div class="quick-amounts">
      <button class="quick-btn" onclick="setAmount(500)">500</button>
      <button class="quick-btn" onclick="setAmount(1000)">1,000</button>
      <button class="quick-btn" onclick="setAmount(5000)">5,000</button>
      <button class="quick-btn" onclick="setAmount(10000)">10,000</button>
    </div>

    <button class="btn btn-primary" onclick="saveDonation()">·Ä°·Äú·Äæ·Ä∞ ·Äë·Ää·Ä∑·Ä∫·Äô·Äö·Ä∫ ‚úä</button>
  </div>

  <!-- Recent Donations -->
  <div class="card">
    <h3>·Äî·Ä±·Ä¨·ÄÄ·Ä∫·ÄÜ·ÄØ·Ä∂·Ä∏ ·Ä°·Äú·Äæ·Ä∞·Äô·Äª·Ä¨·Ä∏</h3>
    <div id="recentList"></div>
  </div>

</div>

<!-- Bottom Navigation -->
<div class="bottom-nav">
  <button class="nav-btn active"><span class="emoji-lg">üè†</span><div>·Äï·ÄÑ·Ä∫·Äô</div></button>
  <button class="nav-btn"><span class="emoji-lg">‚ûï</span><div>·Äë·Ää·Ä∑·Ä∫·Äõ·Äî·Ä∫</div></button>
  <button class="nav-btn"><span class="emoji-lg">üìã</span><div>·ÄÖ·Ä¨·Äõ·ÄÑ·Ä∫·Ä∏</div></button>
  <button class="nav-btn"><span class="emoji-lg">üì§</span><div>Export</div></button>
</div>

<script>
  // ==================== Firebase Config ====================
  const firebaseConfig = {
    apiKey: "AIzaSyBojMFTkLXmaFGqwq9tLKpXp-wXKqkN_no",
    authDomain: "lamp-88a25.firebaseapp.com",
    databaseURL: "https://lamp-88a25-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "lamp-88a25",
    storageBucket: "lamp-88a25.appspot.com"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const jsConfetti = new JSConfetti();

  // ==================== Elements ====================
  const totalEl     = document.getElementById('totalAmount');
  const recentList  = document.getElementById('recentList');
  const nameInput   = document.getElementById('donorName');
  const amountInput = document.getElementById('donationAmount');

  let suggestNames = JSON.parse(localStorage.getItem('suggestNames') || '[]');

  // ==================== Quick amount buttons ====================
  function setAmount(value) {
    amountInput.value = value;
    document.querySelectorAll('.quick-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
  }

  // ==================== Save Donation ====================
  async function saveDonation() {
    const name = nameInput.value.trim();
    const amount = Number(amountInput.value) || 0;

    if (!name || amount < 100) {
      alert("·Ä°·Äô·Ää·Ä∫·Äî·Ä≤·Ä∑ ·Ä°·Äî·Ää·Ä∫·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏ ·ÅÅ·ÅÄ·ÅÄ ·Äò·Äê·Ä∫ ·Äë·Ää·Ä∑·Ä∫·Äï·Ä±·Ä∏·Äï·Ä´");
      return;
    }

    const donation = {
      name,
      amount,
      timestamp: Date.now(),
      week: Math.ceil((new Date().getDate() + new Date().getDay()) / 7)
    };

    try {
      await db.ref('donations').push(donation);

      // Confetti
      jsConfetti.addConfetti({
        emojis: ['‚úä','üî•','üí™','üá≤üá≤'],
        confettiNumber: 60,
      });

      // Add to suggest
      if (!suggestNames.includes(name)) {
        suggestNames.push(name);
        localStorage.setItem('suggestNames', JSON.stringify(suggestNames));
        updateSuggestions();
      }

      // Clear form
      nameInput.value = '';
      amountInput.value = '';
      document.querySelectorAll('.quick-btn').forEach(b => b.classList.remove('active'));

      alert("·Ä°·Äú·Äæ·Ä∞ ·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äº·ÄÑ·Ä∫·ÄÖ·ÄΩ·Ä¨ ·Äë·Ää·Ä∑·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ ‚úä");

    } catch(e) {
      console.error(e);
      alert("·ÄÅ·Äè ·Ä°·Äô·Äæ·Ä¨·Ä∏·Äñ·Äº·ÄÖ·Ä∫·Äû·ÄΩ·Ä¨·Ä∏·Äï·Ä´·Äê·Äö·Ä∫...");
    }
  }

  // ==================== Real-time Listener ====================
  db.ref('donations')
    .orderByChild('timestamp')
    .limitToLast(20)
    .on('value', snapshot => {
      recentList.innerHTML = '';

      let total = 0;
      const fragment = document.createDocumentFragment();

      snapshot.forEach(child => {
        const d = child.val();
        total += d.amount || 0;

        const div = document.createElement('div');
        div.className = 'donation-item';
        div.style.animationDelay = `${Math.random() * 0.4}s`;
        div.innerHTML = `
          <strong>${d.name}</strong>
          <div style="margin-top:6px; font-size:1.3rem; color:var(--green-hope);">
            ${d.amount.toLocaleString()} ·Äò·Äê·Ä∫
          </div>
          <div style="margin-top:6px; font-size:0.85rem; opacity:0.7;">
            ${new Date(d.timestamp).toLocaleString('my-MM')}
          </div>
        `;
        fragment.appendChild(div);
      });

      recentList.appendChild(fragment);
      totalEl.textContent = total.toLocaleString();
    });

  // ==================== Suggestions ====================
  function updateSuggestions() {
    const datalist = document.getElementById('nameSuggestions');
    datalist.innerHTML = '';
    suggestNames.forEach(name => {
      const opt = document.createElement('option');
      opt.value = name;
      datalist.appendChild(opt);
    });
  }

  updateSuggestions();

  // Initial load suggestions from storage
  window.addEventListener('load', updateSuggestions);
</script>

</body>
</html>